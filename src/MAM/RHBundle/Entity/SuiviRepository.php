<?php

namespace MAM\RHBundle\Entity;

use DateTime;
use Doctrine\ORM\EntityRepository;

/**
 * SuiviRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class SuiviRepository extends EntityRepository
{
    public function getsuivis($id){

        $suivis = $this->createQueryBuilder('s')
            // On joint sur l'attribut image
            ->leftJoin('s.projet', 'p')
            ->addSelect('p')
            // On joint sur l'attribut categories
            ->where('p.id = :proj')
            ->andwhere('p.Date_fin < :d')
            ->setParameter('proj', $id)
            ->setParameter('d', new Datetime())
            ->getQuery()
            ->getResult();

        return $suivis;
    }
}
